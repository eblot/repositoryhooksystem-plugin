<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:py="http://genshi.edgewall.org/">
<xi:include href="admin.html" />
<head>
  <title>Repository Hook System</title>
  <script type="text/javascript">
    jQuery(document).ready(function($) {
      $("#addentry input[name='name']").suggest("${href.diff()}");
    });
  </script>
</head>
<body>
    <h2>Repository Hooks</h2>
    <form class="addnew" id="addentry" method="POST">
      <fieldset>
        <legend>Add association:</legend>
        <div class="field">
          <label>Branch name:<br />
            <input type="text" name="name" id="name" />
          </label>
        </div>
        <div class="field">
          <label>Milestone prefix:<br />
            <input type="text" name="prefix" id="prefix" />
          </label>
        </div>
        <div class="buttons">
          <input type="submit" name="add" value="${_('Add')}" />
        </div>
      </fieldset>
    </form>

    <div py:strip="">
      <p py:if="not len(aslist)" class="help">
        <b>No branch-milestone association defined for this project.</b>
      </p>
      <form py:if="len(aslist)" method="POST">
        <table class="listing" id="aslist">
          <thead>
            <tr>
              <th class="sel">&nbsp;</th>
              <th>Branch name or pattern</th>
              <th>Milestone prefix</th>
            </tr>
          </thead>
          <tbody>
            <tr py:for="ass in aslist">
              <td><input type="checkbox" name="sel" value="${ass.name}"/></td>
              <td>${ass.name}</td>
              <td>${ass.prefix}</td>
            </tr>
          </tbody>
        </table>
        <div class="buttons">
          <input type="submit" name="remove"
                 value="${_('Remove selected items')}" />
        </div>
      </form>
        <p class="help">
          By default, the RHS will automatically set the milestone of a ticket
          depending on the source branch of the associated ticket: The milestone is
          chosen based on the name of the branch and due date of opened milestones.
        </p>
        <p class="help">
          For example: a ticket with a sandbox from <code>/branches/indri_cert-1.x</code>
          will be assigned the opened milestone with the nearest due date starting with
          "Indri".
        </p>
        <p class="help">
          If you have branches that do not obey this rule (like the trunk), you can
          use this page to add exceptions. You may use a pattern like:
          <code>/branches/indri(_(cert|dvt))?\-[12]\.[nxyz]</code>
        </p>
    </div>
</body>
</html>
